% ----------------------------------------------------------------------
% Custom commands for manually entering Agda syntax in LaTeX, based on
% agda.sty used for agda --latex.
% ----------------------------------------------------------------------

\ProvidesPackage{agda-syntax}

\RequirePackage{ifxetex, ifluatex, xifthen, xcolor, polytable, etoolbox,
                calc, environ, ifthen}

% https://tex.stackexchange.com/questions/47576/combining-ifxetex-and-ifluatex-with-the-logical-or-operation
\newif\ifxetexorluatex
\ifxetex
  \xetexorluatextrue
\else
  \ifluatex
    \xetexorluatextrue
  \else
    \xetexorluatexfalse
  \fi
\fi

% ----------------------------------------------------------------------
% Options

\DeclareOption{bw}   {\newcommand{\AgdaColourScheme}{bw}}
\DeclareOption{conor}{\newcommand{\AgdaColourScheme}{conor}}

\ProcessOptions\relax

% ----------------------------------------------------------------------
% Colour schemes.

\providecommand{\AgdaColourScheme}{standard}

% ----------------------------------------------------------------------
% Font styles.


% ----------------------------------------------------------------------
% Colours.

% ----------------------------------
% The black and white colour scheme.
\ifthenelse{\equal{\AgdaColourScheme}{bw}}{

    % Aspect colours.
    \definecolor{AgdaComment}      {HTML}{000000}
    \definecolor{AgdaOption}       {HTML}{000000}
    \definecolor{AgdaKeyword}      {HTML}{000000}
    \definecolor{AgdaString}       {HTML}{000000}
    \definecolor{AgdaNumber}       {HTML}{000000}
    \definecolor{AgdaSymbol}       {HTML}{000000}
    \definecolor{AgdaPrimitiveType}{HTML}{000000}

    % NameKind colours.
    \definecolor{AgdaBound}                 {HTML}{000000}
    \definecolor{AgdaInductiveConstructor}  {HTML}{000000}
    \definecolor{AgdaCoinductiveConstructor}{HTML}{000000}
    \definecolor{AgdaDatatype}              {HTML}{000000}
    \definecolor{AgdaField}                 {HTML}{000000}
    \definecolor{AgdaFunction}              {HTML}{000000}
    \definecolor{AgdaMacro}                 {HTML}{000000}
    \definecolor{AgdaModule}                {HTML}{000000}
    \definecolor{AgdaPostulate}             {HTML}{000000}
    \definecolor{AgdaPrimitive}             {HTML}{000000}
    \definecolor{AgdaRecord}                {HTML}{000000}
    \definecolor{AgdaRewrite}                {HTML}{000000}
    \definecolor{AgdaArgument}              {HTML}{000000}

    % Other aspect colours.
    \definecolor{AgdaDottedPattern}     {HTML}{000000}
    \definecolor{AgdaUnsolvedMeta}      {HTML}{D3D3D3}
    \definecolor{AgdaTerminationProblem}{HTML}{BEBEBE}
    \definecolor{AgdaIncompletePattern} {HTML}{D3D3D3}
    \definecolor{AgdaError}             {HTML}{696969}

    % Misc.
    \definecolor{AgdaHole}              {HTML}{BEBEBE}

% ----------------------------------
% Conor McBride's colour scheme.
}{ \ifthenelse{\equal{\AgdaColourScheme}{conor}}{

    % Aspect colours.
    \definecolor{AgdaComment}      {HTML}{B22222}
    \definecolor{AgdaOption}       {HTML}{000000}
    \definecolor{AgdaKeyword}      {HTML}{000000}
    \definecolor{AgdaString}       {HTML}{000000}
    \definecolor{AgdaNumber}       {HTML}{000000}
    \definecolor{AgdaSymbol}       {HTML}{000000}
    \definecolor{AgdaPrimitiveType}{HTML}{0000CD}

    % NameKind colours.
    \definecolor{AgdaBound}                 {HTML}{A020F0}
    \definecolor{AgdaInductiveConstructor}  {HTML}{8B0000}
    \definecolor{AgdaCoinductiveConstructor}{HTML}{8B0000}
    \definecolor{AgdaDatatype}              {HTML}{0000CD}
    \definecolor{AgdaField}                 {HTML}{8B0000}
    \definecolor{AgdaFunction}              {HTML}{006400}
    \definecolor{AgdaMacro}                 {HTML}{006400}
    \definecolor{AgdaModule}                {HTML}{006400}
    \definecolor{AgdaPostulate}             {HTML}{006400}
    \definecolor{AgdaPrimitive}             {HTML}{006400}
    \definecolor{AgdaRecord}                {HTML}{0000CD}
    \definecolor{AgdaRewrite}                {HTML}{0000CD}
    \definecolor{AgdaArgument}              {HTML}{404040}

    % Other aspect colours.
    \definecolor{AgdaDottedPattern}     {HTML}{000000}
    \definecolor{AgdaUnsolvedMeta}      {HTML}{FFD700}
    \definecolor{AgdaTerminationProblem}{HTML}{FF0000}
    \definecolor{AgdaIncompletePattern} {HTML}{A020F0}
    \definecolor{AgdaError}             {HTML}{F4A460}

    % Misc.
    \definecolor{AgdaHole}              {HTML}{9DFF9D}

% ----------------------------------
% The standard colour scheme.
}{
    % Aspect colours.
    \definecolor{AgdaComment}      {HTML}{B22222}
    \definecolor{AgdaOption}       {HTML}{000000}
    \definecolor{AgdaKeyword}      {HTML}{CD6600}
    \definecolor{AgdaString}       {HTML}{B22222}
    \definecolor{AgdaNumber}       {HTML}{A020F0}
    \definecolor{AgdaSymbol}       {HTML}{404040}
    \definecolor{AgdaPrimitiveType}{HTML}{0000CD}

    % NameKind colours.
    \definecolor{AgdaBound}                 {HTML}{000000}
    \definecolor{AgdaInductiveConstructor}  {HTML}{008B00}
    \definecolor{AgdaCoinductiveConstructor}{HTML}{8B7500}
    \definecolor{AgdaDatatype}              {HTML}{0000CD}
    \definecolor{AgdaField}                 {HTML}{EE1289}
    \definecolor{AgdaFunction}              {HTML}{0000CD}
    \definecolor{AgdaMacro}                 {HTML}{458B74}
    \definecolor{AgdaModule}                {HTML}{A020F0}
    \definecolor{AgdaPostulate}             {HTML}{0000CD}
    \definecolor{AgdaPrimitive}             {HTML}{0000CD}
    \definecolor{AgdaRecord}                {HTML}{0000CD}
    \definecolor{AgdaRewrite}                {HTML}{0000CD}
    \definecolor{AgdaArgument}              {HTML}{404040}
    \definecolor{AgdaPattern}              {HTML}{EE1289}

    % Other aspect colours.
    \definecolor{AgdaDottedPattern}     {HTML}{000000}
    \definecolor{AgdaUnsolvedMeta}      {HTML}{FFFF00}
    \definecolor{AgdaTerminationProblem}{HTML}{FFA07A}
    \definecolor{AgdaIncompletePattern} {HTML}{F5DEB3}
    \definecolor{AgdaError}             {HTML}{FF0000}

    % Misc.
    \definecolor{AgdaHole}              {HTML}{9DFF9D}
}}

% ----------------------------------------------------------------------
% Commands.

% NameKind commands.

\providecommand{\AgdaLink}[1]{#1}

\newcommand{\AgdaVar}[1]
    {\AgdaNoSpaceMath{\AgdaBoundFontStyle{\textcolor{AgdaBound}{\AgdaFormat{#1}{#1}}}}}
\newcommand{\AgdaCon}[1]
    {\AgdaNoSpaceMath{\AgdaFontStyle{\textcolor{AgdaInductiveConstructor}{\AgdaFormat{#1}{\AgdaLink{#1}}}}}}
\newcommand{\AgdaData}[1]
    {\AgdaNoSpaceMath{\AgdaFontStyle{\textcolor{AgdaDatatype}{\AgdaFormat{#1}{\AgdaLink{#1}}}}}}
\newcommand{\AgdaFun}[1]
    {\AgdaNoSpaceMath{\AgdaFontStyle{\textcolor{AgdaFunction}{\AgdaFormat{#1}{\AgdaLink{#1}}}}}}
\newcommand{\AgdaPrim}[1]
    {\AgdaNoSpaceMath{\AgdaFontStyle{\textcolor{AgdaPrimitive}{\AgdaFormat{#1}{#1}}}}}
\newcommand{\AgdaArg}[1]
    {\AgdaNoSpaceMath{\AgdaBoundFontStyle{\textcolor{AgdaArgument}{\AgdaFormat{#1}{#1}}}}}
\newcommand{\AgdaPattern}[1]
    {\AgdaNoSpaceMath{\AgdaBoundFontStyle{\textcolor{AgdaPattern}{\AgdaFormat{#1}{#1}}}}}


% Jesper's additions
\newcommand{\AgdaSet}[1]{{\AgdaPrim{Set}_{#1}}}
\newcommand{\AgdaProp}[1]{{\AgdaPrim{Prop}_{#1}}}
\newcommand{\AgdaLevel}{{\AgdaPrim{Level}}}
\newcommand{\AgdaProj}[1]{\AgdaField{.#1}}
\newcommand{\AgdaId}[1]{\mathrel{{\AgdaData{\equiv}}_{#1}}}
\newcommand{\AgdaRefl}{\AgdaCon{refl}}
\newcommand{\AgdaLeq}{\mathrel{\AgdaData{\leq}}}
\newcommand{\AgdaLeqZero}{\AgdaCon{\AgdaCon{lz}}}
\newcommand{\AgdaLeqSuc}{\AgdaCon{\AgdaCon{ls}}}
\newcommand{\AgdaSum}{\mathrel{\AgdaData{\uplus}}}
\newcommand{\AgdaProd}{\mathrel{\AgdaData{\times}}}
\newcommand{\AgdaNat}{\AgdaData{\mathbb{N}}}
\newcommand{\AgdaZero}{\AgdaCon{zero}}
\newcommand{\AgdaSuc}{\AgdaCon{suc}}
\newcommand{\AgdaInt}{\AgdaData{\mathbb{Z}}}
\newcommand{\AgdaTop}{\AgdaData{\top}}
\newcommand{\AgdaBottom}{\AgdaData{\bot}}
\newcommand{\AgdaSigma}{\textcolor{AgdaDatatype}{\Sigma}}
\newcommand{\AgdaBool}{\AgdaData{Bool}}
\newcommand{\AgdaTrue}{\AgdaCon{true}}
\newcommand{\AgdaFalse}{\AgdaCon{false}}

\newcommand{\AgdaFunDecl}[2]{
\begin{array}{@{}l}
  \begin{array}{@{}l} #1 \end{array}  \\
  \begin{array}{@{}l@{\hspace{0.5em}}l@{\hspace{0.5em}}l} #2 \end{array} \\
\end{array}
}

\newcommand{\AgdaDataDecl}[2]{
\begin{array}{@{}l}
  \AgdaKeyword{data} \; #1 \; \AgdaKeyword{where} \\
  \quad  \begin{array}{@{}l@{\hspace{0.5em}}l@{\hspace{0.5em}}l} #2 \end{array} \\
\end{array}
}

\newcommand{\AgdaPostulateDecl}[1]{
  \AgdaKeyword{postulate} \; #1 \\
}

\newcommand{\AgdaRecordDecl}[3]{
\begin{array}{@{}l}
  \AgdaKeyword{record} \; #1 \; \AgdaKeyword{where} \\
  \quad  \begin{array}{@{}l}
    \ifthenelse{\isempty{#2}}{}{\AgdaKeyword{constructor} \; #2 \\}
    \AgdaKeyword{field} \; \begin{array}{@{}l@{\hspace{0.5em}}l@{\hspace{0.5em}}l} #3 \end{array}
  \end{array}
\end{array}
}

\newcommand{\AgdaRewriteDecl}[4]{
\begin{array}{@{}l}
  \AgdaKeyword{postulate rewrite block} \; #1 \; \AgdaKeyword{where} \\
  \quad  \begin{array}{@{}l}
    \ifthenelse{\isempty{#2}}{}{\AgdaKeyword{constructor} \; #2 \\}
    \AgdaKeyword{axiom} 
           \; \left[ \begin{array}{@{}l@{\hspace{0.5em}}l@{\hspace{0.5em}}l}
                #3 \end{array} \right. \\
    \AgdaKeyword{rewrite}
           \; \left[ \begin{array}{@{}l@{\hspace{0.5em}}l@{\hspace{0.5em}}l}
                #4 \end{array} \right.
  \end{array}
\end{array}
}

\endinput
